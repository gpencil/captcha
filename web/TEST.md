# 验证码测试指南

## ✅ 已修复的问题

### 1. 字符验证码
- ✅ 修复：大小写不敏感验证
- ✅ 现在输入大写、小写或混合都可以通过

### 2. 图片选择验证码
- ✅ 修复：图片显示问号的问题
- ✅ 现在显示 "IMAGE 1", "IMAGE 2", "IMAGE 3", "IMAGE 4"
- ✅ 不同颜色的背景（红、绿、蓝、黄）

### 3. 滑动验证码
- ✅ 修复：滑块拖动问题
- ✅ 改进：添加调试日志，可以在浏览器控制台查看
- ✅ 改进：更好的拖动体验

## 🚀 启动测试

```bash
cd /Users/pencil/code/src/yusheng/go-common/captcha-web
./captcha-web-server
```

访问：http://localhost:8080

## 📝 测试步骤

### 字符验证码测试
1. 点击"字符验证码"按钮
2. 点击"生成验证码"
3. 查看图片中的字符（例如：FAPK）
4. 输入小写 `fapk` 或大写 `FAPK` 或混合 `FaPk`
5. 点击"验证"
6. ✅ 应该显示"验证成功！"

### 图片选择验证码测试
1. 点击"图片选择"按钮
2. 点击"生成验证码"
3. 看到问题：例如"请选择所有的公交车"
4. 点击选择 1 张图片（任意颜色）
5. 点击"验证"
6. ✅ 应该显示验证结果

### 滑动验证码测试
1. 点击"滑动验证"按钮
2. 点击"生成验证码"
3. 看到渐变背景图和底部滑块
4. 拖动滑块向右移动
5. 打开浏览器控制台（F12）查看调试信息：
   - "初始化滑块"
   - "开始拖动滑块"
   - "当前位置: xxx"
   - "结束拖动"
   - "最终位置: xxx, 百分比: xx"
6. 点击"验证"
7. ✅ 应该显示验证结果

## 🐛 如果遇到问题

### 字符验证码不显示
- 检查浏览器控制台是否有错误
- 刷新页面重试

### 图片选择显示问号
- 确保 Redis 正在运行
- 重新启动服务

### 滑动验证码无法拖动
- 打开浏览器控制台查看日志
- 确保滑块按钮显示为紫色圆形，里面有"→"箭头
- 尝试在不同位置点击滑块
- 检查是否有 JavaScript 错误

### 验证总是失败
- 检查 Redis 连接
- 确保验证码没有过期（5分钟）
- 重新生成验证码

## 🔍 调试技巧

### 查看浏览器控制台
1. 按 F12 打开开发者工具
2. 切换到 Console 标签
3. 观察日志输出：
   - 滑动验证码会显示详细的拖动信息
   - 验证请求和响应数据

### 查看网络请求
1. 按 F12 打开开发者工具
2. 切换到 Network 标签
3. 生成验证码时查看 `/api/captcha/generate` 请求
4. 验证时查看 `/api/captcha/verify` 请求

### 查看 Redis 数据
```bash
# 连接 Redis
redis-cli

# 查看所有验证码 key
KEYS captcha:*

# 查看某个验证码的内容
GET captcha:uuid-here
```

## 📊 验证码配置

当前配置（main.go）：
- 字符验证码：160x60，4位字符，中等复杂度
- 图片选择验证码：4张图片，选择1张
- 滑动验证码：350x200，滑块60x60
- 过期时间：5分钟

可以修改 main.go 中的配置参数来调整验证码的难度和样式。
